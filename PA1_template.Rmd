---
title: "Reproducible Research Project 1"
author: "Maurizio Murino"
date: "17 December 2015"
output: html_document
---
```{r setoption, echo = TRUE}
echo = TRUE  # The code is displayed
```


## 1. Loading and preprocessing the data

### 1.1. Unzip and read the data  from the GitHub repository. Dimensional exploration.

```{r}
activity <- read.csv(unz("activity.zip", "activity.csv"))
sapply(activity, class)
```

### 1.2. Process/transform the data (if necessary) into a format suitable for your analysis.

activity$date is converted from factor to date class. I used the "zoo" package to manage the time serie which, furthermore, is regularly spaced. The data are collected on 61 days.

``` {r, results = "hide"}

activity$date <- as.Date(activity$date, format = "%Y-%m-%d")
suppressWarnings(library(zoo))
is.regular(activity$date)
unique(activity$date)
```


## 2. What is mean total number of steps taken per day?

### 2.1 Calculate the total number of steps taken per day

The result is calculated and stored in the object "steps_day". Missing values are removed. Since the resulting table is quinte large, I set {r, results = "hide"}. Approximately the 13% of cases in "steps" result in missing data.

```{r, results = 'hide'}
colMeans(is.na(activity))
steps_day <- aggregate(steps ~ date, rm.na = TRUE, data = activity, FUN = sum)
```

### 2.2. Make a histogram of the total number of steps taken each day
Missing gvalues are not omitted in this plot.

```{r}
plot(steps_day, type = "h", lwd = 10, lend = "square")
```

### 2.3. Calculate and report the mean and median of the total number of steps taken per day.

Since those calculations return two large tables the results are not shown.


```{r, results="hide"}
aggregate(steps ~ date, data = activity, FUN = mean)
aggregate(steps ~ date, data = activity, FUN = median)
```

## 3. What is the average daily activity pattern?

### 3.1. Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)

``` {r}
plot(aggregate(steps ~ interval, data = activity, FUN = mean), type = "l")
```

### 3.2. Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?

The base function max() should rapidly give us the answer.

``` {r}
max(activity$steps, na.rm = TRUE)
```


